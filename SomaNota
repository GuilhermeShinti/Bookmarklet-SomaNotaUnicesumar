javascript:(function(){
	linha = document.getElementsByTagName("tr")[4];
	if(!linha.getElementsByTagName("td")[9]){
		linha.insertCell(9);
		linha.getElementsByTagName("td")[9].innerHTML = "TOTAL"
		linha.getElementsByTagName("td")[9].style.font = "bold 12px arial";
                linha.insertCell(10);
                linha.getElementsByTagName("td")[10].innerHTML = "FALTAM"
		linha.getElementsByTagName("td")[10].style.font = "bold 12px arial";
		limite = document.getElementsByTagName("tr").length-8; 
		for(j=5;j<limite+5;j++){     
			total = 0;     
			linha = document.getElementsByTagName("tr")[j];     
			for(i=1;i<9;i++){  
				if (!isNaN(parseInt(linha.getElementsByTagName("td")[i].textContent.replace('.','')))) {
					switch(i) {
					    case 3:
					        if (parseInt(linha.getElementsByTagName("td")[3].textContent.replace('.','')) > parseInt(linha.getElementsByTagName("td")[1].textContent.replace('.',''))) {
					        	total = total - parseInt(linha.getElementsByTagName("td")[1].textContent.replace('.',''));
					        } else {
					        	total = total - parseInt(linha.getElementsByTagName("td")[3].textContent.replace('.',''));
					        }
					        break;
					    case 4:
					        if (parseInt(linha.getElementsByTagName("td")[4].textContent.replace('.','')) > parseInt(linha.getElementsByTagName("td")[2].textContent.replace('.',''))) {
					        	total = total - parseInt(linha.getElementsByTagName("td")[2].textContent.replace('.',''));
					        } else {
					        	total = total - parseInt(linha.getElementsByTagName("td")[4].textContent.replace('.',''));
					        }
					        break;
					    case 7:
					        if (parseInt(linha.getElementsByTagName("td")[7].textContent.replace('.','')) > parseInt(linha.getElementsByTagName("td")[5].textContent.replace('.',''))) {
					        	total = total - parseInt(linha.getElementsByTagName("td")[5].textContent.replace('.',''));
					        } else {
					        	total = total - parseInt(linha.getElementsByTagName("td")[7].textContent.replace('.',''));
					        }
					        break;
					    case 8:
					        if (parseInt(linha.getElementsByTagName("td")[8].textContent.replace('.','')) > parseInt(linha.getElementsByTagName("td")[6].textContent.replace('.',''))) {
					        	total = total - parseInt(linha.getElementsByTagName("td")[6].textContent.replace('.',''));
					        } else {
					        	total = total - parseInt(linha.getElementsByTagName("td")[8].textContent.replace('.',''));
					        }
					        break;
					}
				};
				       

				if(!isNaN(parseInt(linha.getElementsByTagName("td")[i].textContent.replace('.','')))){             
					total = total + parseInt(linha.getElementsByTagName("td")[i].textContent.replace('.',''));
				}     
			}     
            linha.insertCell(10);
		    if(total>=240){cor = "#218530"} else {cor = "#851D1D"}
			linha.getElementsByTagName("td")[9].innerHTML = total;
		    linha.getElementsByTagName("td")[9].style.color = cor;
            linha.getElementsByTagName("td")[10].innerHTML = total - 240;
		    linha.getElementsByTagName("td")[10].style.color = cor;
		    linha.getElementsByTagName("td")[10].className = "font01";
            linha.getElementsByTagName("td")[10].setAttribute("align", "right");
		}
	} else {
		alert("As notas j√° foram somadas!")
}
})();